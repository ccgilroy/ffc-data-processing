<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Connor Gilroy" />

<meta name="date" content="2017-07-25" />

<title>Variable Metadata</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Variable Metadata</h1>
<h4 class="author"><em>Connor Gilroy</em></h4>
<h4 class="date"><em>2017-07-25</em></h4>



<p>This is a more opinionated version of <a href="https://ccgilroy.github.io/ffc-data-processing/vignettes/example1.html">Example 1</a>.</p>
<p>Instead of leaving some variables as unknown, it classifies <em>all</em> variables as either categorical or continuous. Instead of relying on users of the metadata to make corrections, it manually corrects censored variables and other variables that have been clearly misclassified. Misclassifications are determined as indicated by the variable metadata (the variable label and the number of unique values), using the author’s best judgment.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="st">&quot;init.R&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># this section is almost identical to Example 1</span>
<span class="co"># process all variables, making best guess about character variables</span>
<span class="co"># does not handle missing values, does not remove any variables</span>
<span class="co"># then summarize variable type information </span>

background &lt;-<span class="st"> </span><span class="kw">read_dta</span>(<span class="st">&quot;data/background.dta&quot;</span>)

background_processed &lt;-<span class="st"> </span>
<span class="st">  </span>background %&gt;%
<span class="st">  </span><span class="kw">recode_na_character</span>() %&gt;%
<span class="st">  </span><span class="kw">labelled_to_factor</span>() %&gt;%
<span class="st">  </span><span class="kw">labelled_to_numeric</span>() %&gt;%
<span class="st">  </span><span class="kw">character_to_factor</span>() %&gt;%
<span class="st">  </span><span class="kw">character_to_numeric</span>() %&gt;%
<span class="st">  </span><span class="co"># use a less conservative threshold than default</span>
<span class="st">  </span><span class="kw">character_to_factor_or_numeric</span>(<span class="dt">threshold =</span> <span class="dv">29</span>) 

variable_types &lt;-<span class="st"> </span><span class="kw">summarize_variables</span>(background, background_processed)

variable_types %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(variable_type) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">count</span>()</code></pre></div>
<pre><code>## # A tibble: 3 x 2
## # Groups:   variable_type [3]
##   variable_type     n
##           &lt;chr&gt; &lt;int&gt;
## 1   categorical 11110
## 2    continuous  1832
## 3          &lt;NA&gt;     1</code></pre>
<p>Now, look at variable metadata and look for misclassified variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># This process is also described in the integration vignette</span>
variable_metadata &lt;-<span class="st"> </span>
<span class="st">  </span>variable_types %&gt;%
<span class="st">  </span><span class="kw">arrange</span>(variable_type, <span class="kw">desc</span>(unique_values))

variable_metadata %&gt;%<span class="st"> </span><span class="kw">head</span>(<span class="dv">10</span>) %&gt;%<span class="st"> </span><span class="kw">print</span>(<span class="dt">width =</span> <span class="dv">93</span>)</code></pre></div>
<pre><code>## # A tibble: 10 x 4
##    variable                                                                            label
##       &lt;chr&gt;                                                                            &lt;chr&gt;
##  1    m1j2a               In last 12 mo, about how much money did you receive from earnings?
##  2    m4k19              How much did you earn from all reg jobs in past 12 months (amount)?
##  3    m3k19                    How much did you earn from all regular jobs in past year? ($)
##  4    m1j2b          In 12 mo, about how much money did you receive from pub. assis/welfare?
##  5    m1j2d         In last 12 mo, about how much money did you receive from family/friends?
##  6    m5b12                                B12. Amount payments are supposed to be per month
##  7    f5b12                                B12. Amount the payments supposed to be per month
##  8    f1k2c                              How much money did you receive from Family/Friends?
##  9    m1j2c In last 12 mo, about how much money did you receive from unemployment/SS/disabil
## 10    f1k2b                  How much money did you receive from Unemployment/SS/Disability?
## # ... with 2 more variables: unique_values &lt;dbl&gt;, variable_type &lt;chr&gt;</code></pre>
<p>Below are indices of variables that have been classified as categorical, but <em>should</em> be classified as continuous, <strong>as ordered by variable type and unique values</strong>.</p>
<ul>
<li>The first group are generally clearly continuous. Often these are censored at the top or bottom of their range.</li>
<li>The second group are often ordinal, referring to e.g. income brackets. Some income variables refer to labelled income brackets (e.g. <code>f1j16a, b, c, d</code>), others have some noise incorporated and are addressed as part of the first group.</li>
<li>The third group are a series of ordinal questions asked to the child in wave 5.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># variables selected manually</span>
indices &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">45</span>, <span class="dv">47</span>:<span class="dv">63</span>, <span class="dv">66</span>, <span class="dv">68</span>:<span class="dv">72</span>, <span class="dv">77</span>:<span class="dv">80</span>, <span class="dv">83</span>:<span class="dv">84</span>, <span class="dv">87</span>:<span class="dv">88</span>, <span class="dv">91</span>:<span class="dv">92</span>, <span class="dv">97</span>, <span class="dv">101</span>:<span class="dv">102</span>,
             <span class="dv">106</span>:<span class="dv">107</span>, <span class="dv">116</span>:<span class="dv">119</span>, <span class="dv">121</span>:<span class="dv">122</span>, <span class="dv">127</span>:<span class="dv">130</span>, <span class="dv">151</span>, <span class="dv">154</span>:<span class="dv">160</span>, <span class="dv">174</span>, <span class="dv">179</span>, <span class="dv">182</span>,
             <span class="dv">185</span>:<span class="dv">186</span>, <span class="dv">219</span>:<span class="dv">223</span>, <span class="dv">260</span>, <span class="dv">277</span>:<span class="dv">282</span>, <span class="dv">300</span>, <span class="dv">335</span>:<span class="dv">345</span>, <span class="dv">362</span>, <span class="dv">452</span>:<span class="dv">462</span>, <span class="dv">945</span>,
             <span class="dv">960</span>:<span class="dv">961</span>, <span class="dv">972</span>:<span class="dv">980</span>, <span class="dv">1003</span>:<span class="dv">1007</span>, <span class="dv">1029</span>:<span class="dv">1033</span>)

<span class="co"># income and expense variables (also manual)</span>
<span class="co"># (ordinal, very inconsistent scales, frequently unevenly spaced)</span>
inc_and_exp &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">98</span>, <span class="dv">108</span>, <span class="dv">188</span>, <span class="dv">320</span>:<span class="dv">321</span>, <span class="dv">327</span>:<span class="dv">328</span>, <span class="dv">333</span>, <span class="dv">347</span>, <span class="dv">349</span>, <span class="dv">350</span>, <span class="dv">357</span>:<span class="dv">358</span>,
                 <span class="dv">377</span>:<span class="dv">378</span>, <span class="dv">390</span>, <span class="dv">394</span>, <span class="dv">400</span>:<span class="dv">401</span>, <span class="dv">403</span>:<span class="dv">404</span>, <span class="dv">464</span>:<span class="dv">465</span>, <span class="dv">962</span>)
<span class="co"># some child-support variables are more similar to the days/week variables </span>
<span class="co"># described below; these are excluded</span>

<span class="co"># kid questions - frequency, amount</span>
k5 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1118</span>:<span class="dv">1159</span>)

categorical_to_continuous &lt;-<span class="st"> </span>
<span class="st">  </span>variable_metadata$variable[<span class="kw">c</span>(indices, inc_and_exp, k5)]

categorical_to_continuous</code></pre></div>
<pre><code>##   [1] &quot;m1j2a&quot;                  &quot;m4k19&quot;                 
##   [3] &quot;m3k19&quot;                  &quot;m1j2b&quot;                 
##   [5] &quot;m1j2d&quot;                  &quot;m5b12&quot;                 
##   [7] &quot;f5b12&quot;                  &quot;f1k2c&quot;                 
##   [9] &quot;m1j2c&quot;                  &quot;f1k2b&quot;                 
##  [11] &quot;m3c20c&quot;                 &quot;f1k2a&quot;                 
##  [13] &quot;hv5_wj10pr&quot;             &quot;hv5_wj9pr&quot;             
##  [15] &quot;f2k22e1&quot;                &quot;hv5_ppvtae&quot;            
##  [17] &quot;hv5_ppvtpr&quot;             &quot;f4a3c&quot;                 
##  [19] &quot;f3a3c&quot;                  &quot;cf4age&quot;                
##  [21] &quot;f4a3&quot;                   &quot;m4a10g1&quot;               
##  [23] &quot;m4a10g2&quot;                &quot;m4a10g3&quot;               
##  [25] &quot;m4e3&quot;                   &quot;f4a10g1&quot;               
##  [27] &quot;f4a10g2&quot;                &quot;cm4age&quot;                
##  [29] &quot;f4a10g3&quot;                &quot;hv5_wj9ae&quot;             
##  [31] &quot;hv5_wj10ae&quot;             &quot;f4e3&quot;                  
##  [33] &quot;m2a8a1b&quot;                &quot;f3a3&quot;                  
##  [35] &quot;m4a12a1c&quot;               &quot;f4a12a1c&quot;              
##  [37] &quot;m4a12c1c&quot;               &quot;f4a12c1c&quot;              
##  [39] &quot;m1h2c&quot;                  &quot;f1h2c&quot;                 
##  [41] &quot;f3i27b&quot;                 &quot;m4j13a&quot;                
##  [43] &quot;ffcc_centsurvey_c3_e&quot;   &quot;ffcc_centsurvey_f5_yr&quot; 
##  [45] &quot;ffcc_famsurvey_e6_yr&quot;   &quot;ffcc_centsurvey_c4&quot;    
##  [47] &quot;ffcc_centsurvey_g17&quot;    &quot;cm3amrf&quot;               
##  [49] &quot;f3i31b&quot;                 &quot;cm4amrf&quot;               
##  [51] &quot;hv3b2a&quot;                 &quot;hv3pvpercom&quot;           
##  [53] &quot;ffcc_centsurvey_g16_d&quot;  &quot;ffcc_centsurvey_g22a_1&quot;
##  [55] &quot;cm3alvf&quot;                &quot;cm4alvf&quot;               
##  [57] &quot;hv4b8&quot;                  &quot;hv4tvipraw_m&quot;          
##  [59] &quot;kind_g7cyr&quot;             &quot;ffcc_centsurvey_f4_yr&quot; 
##  [61] &quot;m3c22b&quot;                 &quot;f3i13b&quot;                
##  [63] &quot;hv3ppvtage&quot;             &quot;ffcc_centsurvey_c3_f&quot;  
##  [65] &quot;m2c37a4&quot;                &quot;f2fh26b&quot;               
##  [67] &quot;m3i13b&quot;                 &quot;m4a5a2&quot;                
##  [69] &quot;hv3a7&quot;                  &quot;hv4tvipstd_m&quot;          
##  [71] &quot;ffcc_famsurvey_f28a_yr&quot; &quot;ffcc_famobs_age&quot;       
##  [73] &quot;m2h11a2&quot;                &quot;f2h9d2&quot;                
##  [75] &quot;m4i13b&quot;                 &quot;m4k9b&quot;                 
##  [77] &quot;f4i13b&quot;                 &quot;f4k9b&quot;                 
##  [79] &quot;m1e1d8&quot;                 &quot;f4a5a2&quot;                
##  [81] &quot;f4a6a2&quot;                 &quot;hv3b1a&quot;                
##  [83] &quot;hv4agemos&quot;              &quot;m4a6a2&quot;                
##  [85] &quot;m4a12a2c&quot;               &quot;m4f1&quot;                  
##  [87] &quot;f4a12a2c&quot;               &quot;hv3b14&quot;                
##  [89] &quot;hv3f1&quot;                  &quot;hv4ppvtage&quot;            
##  [91] &quot;kind_attention_scale&quot;   &quot;ffcc_famsurvey_a3&quot;     
##  [93] &quot;ffcc_famsurvey_b2&quot;      &quot;hv3b15&quot;                
##  [95] &quot;hv3pvpercom_m&quot;          &quot;hv4a12&quot;                
##  [97] &quot;hv4b1&quot;                  &quot;hv4b2&quot;                 
##  [99] &quot;hv4e1&quot;                  &quot;ffcc_centsurvey_c3_d&quot;  
## [101] &quot;ffcc_famsurvey_total&quot;   &quot;f3a5a1&quot;                
## [103] &quot;cf4b_age&quot;               &quot;f5d4m&quot;                 
## [105] &quot;hv3a21&quot;                 &quot;ffcc_famsurvey_b9&quot;     
## [107] &quot;hv3tvipage&quot;             &quot;hv3pvbasal_m&quot;          
## [109] &quot;hv4a24&quot;                 &quot;hv4a28&quot;                
## [111] &quot;hv4b23&quot;                 &quot;m4a12c2c&quot;              
## [113] &quot;hv3f3&quot;                  &quot;hv4b5&quot;                 
## [115] &quot;hv4b6&quot;                  &quot;hv4e3&quot;                 
## [117] &quot;ffcc_famsurvey_b31&quot;     &quot;ffcc_famsurvey_f28_yr&quot; 
## [119] &quot;f2f1&quot;                   &quot;hv3f5&quot;                 
## [121] &quot;hv3pvceil_m&quot;            &quot;hv4b4&quot;                 
## [123] &quot;hv4b24&quot;                 &quot;hv4e5&quot;                 
## [125] &quot;hv4pvbasal_m&quot;           &quot;ffcc_centsurvey_b7&quot;    
## [127] &quot;ffcc_centsurvey_c5&quot;     &quot;ffcc_famsurvey_b5_hr&quot;  
## [129] &quot;ffcc_famsurvey_b5_ah&quot;   &quot;ffcc_famsurvey_f11&quot;    
## [131] &quot;f2b17c&quot;                 &quot;f1g9a&quot;                 
## [133] &quot;f1g9b&quot;                  &quot;f1g9c&quot;                 
## [135] &quot;f1g9d&quot;                  &quot;f1g9e&quot;                 
## [137] &quot;f1g9f&quot;                  &quot;f1g9g&quot;                 
## [139] &quot;f1g9i&quot;                  &quot;f1g9j&quot;                 
## [141] &quot;f1g9k&quot;                  &quot;f1g9l&quot;                 
## [143] &quot;p5i11&quot;                  &quot;p5j2g&quot;                 
## [145] &quot;p5j2i&quot;                  &quot;ffcc_famsurvey_a4_b&quot;   
## [147] &quot;ffcc_famsurvey_a4_a05&quot;  &quot;ffcc_famsurvey_a5d_5&quot;  
## [149] &quot;ffcc_famsurvey_b5_min&quot;  &quot;ffcc_famsurvey_b5_am&quot;  
## [151] &quot;ffcc_famsurvey_b29_a&quot;   &quot;ffcc_famsurvey_b32_b&quot;  
## [153] &quot;ffcc_famsurvey_b33&quot;     &quot;ffcc_famsurvey_b47&quot;    
## [155] &quot;m2b17e&quot;                 &quot;m2b43a&quot;                
## [157] &quot;m2b43c&quot;                 &quot;m2b43d&quot;                
## [159] &quot;m2b43e&quot;                 &quot;f2b37a&quot;                
## [161] &quot;f2b37b&quot;                 &quot;f2b37c&quot;                
## [163] &quot;f2b37e&quot;                 &quot;f2b37f&quot;                
## [165] &quot;f1j16b&quot;                 &quot;f1j16a&quot;                
## [167] &quot;f1j16d&quot;                 &quot;m5i20&quot;                 
## [169] &quot;m5j1a&quot;                  &quot;f5i20&quot;                 
## [171] &quot;f5j1a&quot;                  &quot;n5e3a&quot;                 
## [173] &quot;m1j3&quot;                   &quot;f1k3&quot;                  
## [175] &quot;m2c38a&quot;                 &quot;m2k15a&quot;                
## [177] &quot;m2l1a&quot;                  &quot;f2k20a&quot;                
## [179] &quot;f2l1a&quot;                  &quot;f3k21&quot;                 
## [181] &quot;m4b8e&quot;                  &quot;m4k20&quot;                 
## [183] &quot;m4l1a&quot;                  &quot;f4b8e&quot;                 
## [185] &quot;f4b14&quot;                  &quot;m2c16a1&quot;               
## [187] &quot;m2c20b1&quot;                &quot;p5j7b&quot;                 
## [189] &quot;k5a2a&quot;                  &quot;k5a2b&quot;                 
## [191] &quot;k5a2c&quot;                  &quot;k5a2d&quot;                 
## [193] &quot;k5a2e&quot;                  &quot;k5a2f&quot;                 
## [195] &quot;k5a3a&quot;                  &quot;k5a3b&quot;                 
## [197] &quot;k5a3c&quot;                  &quot;k5a3d&quot;                 
## [199] &quot;k5a3e&quot;                  &quot;k5a3f&quot;                 
## [201] &quot;k5a4a&quot;                  &quot;k5a4b&quot;                 
## [203] &quot;k5a4c&quot;                  &quot;k5a4d&quot;                 
## [205] &quot;k5a4e&quot;                  &quot;k5a4f&quot;                 
## [207] &quot;k5c1&quot;                   &quot;k5c1a&quot;                 
## [209] &quot;k5c2&quot;                   &quot;k5c3&quot;                  
## [211] &quot;k5c4&quot;                   &quot;k5c5&quot;                  
## [213] &quot;k5c6&quot;                   &quot;k5c7&quot;                  
## [215] &quot;k5d1a&quot;                  &quot;k5d1b&quot;                 
## [217] &quot;k5d1c&quot;                  &quot;k5d1d&quot;                 
## [219] &quot;k5d1e&quot;                  &quot;k5d1f&quot;                 
## [221] &quot;k5d1g&quot;                  &quot;k5d1h&quot;                 
## [223] &quot;k5e1a&quot;                  &quot;k5e1b&quot;                 
## [225] &quot;k5e1c&quot;                  &quot;k5e1d&quot;                 
## [227] &quot;k5e2a&quot;                  &quot;k5e2b&quot;                 
## [229] &quot;k5e2c&quot;                  &quot;k5e2d&quot;</code></pre>
<p><strong>THIS IS <em>NOT</em> A COMPREHENSIVE LIST OF VARIABLES THAT COULD BE RECLASSIFIED FROM CATEGORICAL TO CONTINUOUS.</strong></p>
<p>Some variables that <em>can’t</em> really be dealt with using this method, and are left as categorical despite being mostly numeric:</p>
<ul>
<li>variables like <code>m4c22b</code> which ask how many days a month a child is supposed to spend with the other parent in case of divorce/separation, but includes options like “Every other week” in addition to 0-31.</li>
<li>variables like <code>m2b18b</code> which ask about # days/week a parent does an activity with the child, but includes options like “several” in addition to 0-7. There are an estimated <strong>230</strong> variables like this.</li>
</ul>
<p>Some that <em>might</em> be addressable, but that I don’t address. These tend to be small ordinal scales:</p>
<ul>
<li><code>m2c23a-f</code> is often-never (1-4), but may have weird values.</li>
<li>some are 1-5 (least like to most like), like <code>m2b17e</code>.</li>
<li>there are lots of other “frequency”, “how often”, and “amount” questions, many of which are truncated. The biggest “gotcha” is when one of these questions has a large value used as an indicator (e.g. 1-5, 201, 202…). It’s hard to predict when they will.</li>
</ul>
<p>An idea to help validate classification would be to look for keywords in the labels like “how much” or “why” that indicate a continuous or categorical response, respectively.</p>
<p>Now, relabel the variables listed above.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">variable_types &lt;-<span class="st"> </span>
<span class="st">  </span>variable_types %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">variable_type =</span> <span class="kw">ifelse</span>(variable %in%<span class="st"> </span>categorical_to_continuous, 
                           <span class="st">&quot;continuous&quot;</span>, variable_type)
    )

variable_types %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(variable_type) %&gt;%
<span class="st">  </span><span class="kw">count</span>()</code></pre></div>
<pre><code>## # A tibble: 3 x 2
## # Groups:   variable_type [3]
##   variable_type     n
##           &lt;chr&gt; &lt;int&gt;
## 1   categorical 10880
## 2    continuous  2062
## 3          &lt;NA&gt;     1</code></pre>
<p>Get the names of categorical and continuous variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">categorical_vars &lt;-<span class="st"> </span>
<span class="st">  </span>variable_types %&gt;%
<span class="st">  </span><span class="kw">filter</span>(variable_type ==<span class="st"> &quot;categorical&quot;</span>) %&gt;%
<span class="st">  </span>.$variable

continuous_vars &lt;-<span class="st"> </span>
<span class="st">  </span>variable_types %&gt;%
<span class="st">  </span><span class="kw">filter</span>(variable_type ==<span class="st"> &quot;continuous&quot;</span>) %&gt;%
<span class="st">  </span>.$variable</code></pre></div>
<p>Store output.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if (!<span class="kw">dir.exists</span>(<span class="st">&quot;output&quot;</span>)) <span class="kw">dir.create</span>(<span class="st">&quot;output&quot;</span>)
<span class="kw">write_csv</span>(variable_types, <span class="st">&quot;output/variable_metadata.csv&quot;</span>)

<span class="kw">write_lines</span>(categorical_to_continuous, <span class="st">&quot;output/categorical_to_continuous.txt&quot;</span>)
<span class="kw">write_lines</span>(categorical_vars, <span class="st">&quot;output/categorical.txt&quot;</span>)
<span class="kw">write_lines</span>(continuous_vars, <span class="st">&quot;output/continuous.txt&quot;</span>)</code></pre></div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
